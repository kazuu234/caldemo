# 海外旅行コミュニティアプリ - 機能説明書

このアプリは、海外旅行の予定を共有し、旅行先で他のメンバーと合流できるコミュニティアプリです。

## 主要機能

### 1. 旅行予定の共有と閲覧

旅行予定を登録して、コミュニティメンバー全員と共有できます。

**できること:**
- 旅行予定の登録（国、都市、日程、メモ）
- みんなの予定の閲覧
- 自分の予定の管理（編集・削除）
- カレンダー形式での表示
- リスト形式での表示
- 国・地域でのフィルター検索

### 2. Discord認証システム

特定のDiscordサーバーのメンバー限定で利用できる安全な認証システムです。

**認証の流れ:**
1. Discordアカウント名を入力して検索
2. 候補から自分のアカウントを選択
3. DiscordのDM（ダイレクトメッセージ）に認証リンクが届く
4. リンクをクリックして認証完了

**特徴:**
- パスワード不要
- ワンタイムリンク（15分間有効）
- 認証情報は自動保存（次回から入力不要）

### 3. 合流募集機能

旅行先で一緒に観光や食事をしたい仲間を募集できます。

**できること:**
- 募集人数の設定（最小・最大）
- 募集内容の詳細記載
- 参加者の検索・登録
- 参加者一覧の確認
- 募集への参加・退出

**表示設定:**
- 「みんなの予定」に表示するかどうかを選択可能
- 非表示にしても参加者には表示されます

### 4. 通知機能

新しい募集や参加者が増えた時に通知を受け取れます。

**通知の種類:**
- ブラウザ通知（デスクトップ・モバイル）
- バッジ表示（アプリアイコンに未読件数）
- アプリ内通知ドット

**設定:**
- 初回アクセス時に通知許可をリクエスト
- ブラウザ設定でいつでもオン/オフ可能

## 画面構成

### ホーム画面

アプリのメイン画面です。

**表示切替タブ:**
- **みんなの予定**: 全メンバーの旅行予定（非表示設定を除く）
- **自分の予定**: ログインユーザーの旅行予定のみ
- **合流募集**: 募集中の旅行のみ

**表示形式:**
- **カレンダービュー**: 月単位でカレンダー表示
- **リストビュー**: 時系列で一覧表示

**ヘッダー:**
- 認証状態の表示（ログイン/ログアウト）
- ユーザー名とアバター表示
- 通知アイコン（未読件数バッジ付き）

**フッターナビゲーション:**
- ホーム
- 予定追加
- 合流募集一覧
- 検索
- 設定

### 予定追加画面

新しい旅行予定を登録する画面です。

**入力項目:**
- **国**: 195の国・地域から選択（検索可能）
- **都市**: 自由入力
- **開始日**: カレンダーから選択
- **終了日**: カレンダーから選択
- **旅行メモ**: 自由記述（オプション）
- **合流募集**: オン/オフ切替
  - オンの場合: 募集内容、募集人数を設定
  - 「みんなの予定に表示」のチェックボックス

**バリデーション:**
- 終了日は開始日以降である必要があります
- 募集人数: 最小人数 ≦ 最大人数

### 予定編集画面

既存の旅行予定を編集・削除する画面です。

**できること:**
- 全項目の編集（追加画面と同じ項目）
- 予定の削除
- 募集のオン/オフ切替

**制限:**
- 自分の予定のみ編集可能
- 他のユーザーの予定は閲覧のみ

### 合流募集一覧画面

現在募集中の旅行一覧を表示します。

**表示内容:**
- ユーザー名とアバター
- 国・都市
- 日程
- 募集内容
- 募集人数（現在の参加者数 / 最大人数）
- 参加者一覧

**できること:**
- 募集への参加
- 募集からの退出
- 参加者の検索・追加（募集作成者のみ）

### 検索画面

旅行予定を検索する画面です。

**検索条件:**
- **国・地域**: 複数選択可能（チェックボックス）
- **表示対象**: みんなの予定 / 自分の予定 / 合流募集

**検索結果:**
- 条件に一致する予定をリスト表示
- 日付順にソート

## 使い方

### 初回利用

1. アプリにアクセス
2. 「ログイン」ボタンをクリック
3. Discordアカウント名を入力
4. 候補から自分を選択
5. DiscordのDMを確認して認証リンクをクリック
6. 認証完了！

### 旅行予定を登録

1. フッターの「＋」ボタンをタップ
2. 国・都市・日程を入力
3. 必要に応じてメモを記入
4. 「保存」をタップ

### 合流募集を作成

1. 旅行予定を登録する際、「合流募集」をオン
2. 募集内容を記入（例: 「一緒にディナーに行きましょう！」）
3. 募集人数を設定
4. 「みんなの予定に表示」をチェック（公開する場合）
5. 「保存」をタップ

### 募集に参加

1. 合流募集一覧から参加したい募集を選択
2. 「参加する」ボタンをタップ
3. 参加者一覧に自分が追加されます

### カレンダーで予定を確認

1. ホーム画面でカレンダーアイコンをタップ
2. 月を切り替えて予定を確認
3. 日付をタップすると、その日の予定一覧が表示

### 国でフィルター

1. ホーム画面の「フィルター」ボタンをタップ
2. 表示したい国にチェック
3. 「適用」をタップ
4. 選択した国の予定のみ表示されます

## 詳細機能

### カレンダービュー

**特徴:**
- 月単位で予定を表示
- 予定がある日はドット表示
- 日付をタップすると詳細表示

**操作:**
- 「＜」「＞」ボタンで月を移動
- 「今月」ボタンで現在の月に戻る

### リストビュー

**特徴:**
- 時系列で予定を表示
- 過去・現在・未来の予定すべて表示
- スクロールで全予定を確認

**表示情報:**
- ユーザー名とアバター
- 国・都市
- 日程
- 旅行メモ
- 合流募集バッジ（募集中の場合）
- 参加者数（募集の場合）

### 国・地域フィルター

**対応国・地域:** 195か国
- アジア、ヨーロッパ、北米、南米、アフリカ、オセアニア、中東
- 国旗絵文字付き
- 検索ボックスで素早く検索可能

**使い方:**
- 複数の国を同時選択可能
- 選択を解除するとすべての国が表示される

### Discord連携

**できること:**
- Discord認証でログイン
- Discordのユーザー名・アバターを自動取得
- DiscordのDMで認証リンク受信

**セキュリティ:**
- ワンタイムリンク（使用後は無効化）
- 15分間の有効期限
- 特定のDiscordサーバーメンバーのみアクセス可能

### 参加者管理

**募集作成者ができること:**
- 参加者の検索（Discord表示名で検索）
- 手動で参加者を追加
- 参加者の削除

**参加者ができること:**
- 自分で参加
- 自分で退出

**参加制限:**
- 最大人数に達すると「満員」表示
- 募集作成者は制限なし

### 通知設定

**通知タイミング:**
- 新しい合流募集が作成された時
- 募集に新しい参加者が加わった時
- 自分の募集に参加者が増えた時

**通知内容:**
- タイトル: イベント名
- 本文: 詳細情報
- クリックすると該当の予定に移動

**バッジ表示:**
- アプリアイコンに未読件数を表示（対応ブラウザのみ）
- 確認すると自動的にクリア

## PWA（プログレッシブWebアプリ）機能

### ホーム画面に追加

**メリット:**
- アプリのようにアイコンから起動
- 全画面表示
- オフラインでも一部機能が利用可能

**追加方法:**

**iOS (Safari):**
1. Safariでアプリを開く
2. 共有ボタンをタップ
3. 「ホーム画面に追加」をタップ

**Android (Chrome):**
1. Chromeでアプリを開く
2. メニュー (⋮) をタップ
3. 「ホーム画面に追加」をタップ

**デスクトップ (Chrome/Edge):**
1. アドレスバーの右側のインストールアイコンをクリック
2. 「インストール」をクリック

### オフライン対応

**利用可能な機能:**
- 既に読み込んだ予定の閲覧
- カレンダービューの表示
- リストビューの表示

**利用できない機能:**
- 新しい予定の追加
- 予定の編集・削除
- 最新情報の取得
- Discord認証

## データの保存

### 現在の仕様（localStorage）

**保存される情報:**
- ログイン情報（認証トークン）
- 未読通知件数

**保存されない情報:**
- 旅行予定（リロードでリセット）

### 将来の仕様（バックエンド連携後）

**保存される情報:**
- すべての旅行予定
- 参加者情報
- 募集情報
- 通知履歴

**同期:**
- 複数デバイス間で同期
- リアルタイム更新

## プライバシーとセキュリティ

### 収集される情報

- Discordユーザー名
- Discord表示名
- Discordアバター
- Discord ID
- 旅行予定情報（国、都市、日程、メモ）

### 公開範囲

**公開される情報:**
- 「みんなの予定に表示」をチェックした旅行予定
- 合流募集情報
- 参加者情報

**非公開の情報:**
- 「みんなの予定に表示」をチェックしていない予定
- Discord ID（内部処理のみ）

### データの削除

- 旅行予定は自分でいつでも削除可能
- ログアウトすると認証情報が削除されます

## よくある質問（FAQ）

### Q1: Discordアカウントがないと使えませんか？
A: はい、このアプリは特定のDiscordサーバーのメンバー限定です。

### Q2: パスワードは必要ですか？
A: いいえ、DiscordのDM経由でログインするためパスワードは不要です。

### Q3: 旅行予定を非公開にできますか？
A: はい、「みんなの予定に表示」のチェックを外すことで非公開にできます。ただし、合流募集の参加者には表示されます。

### Q4: 募集人数を途中で変更できますか？
A: はい、予定の編集画面から変更できます。

### Q5: 参加者を手動で追加できますか？
A: はい、募集作成者は参加者を検索して追加できます。

### Q6: 過去の旅行予定も表示されますか？
A: はい、リストビューでは過去の予定も表示されます。

### Q7: スマホとPCで同じアカウントを使えますか？
A: 将来のバックエンド連携後は可能になります。現在は各デバイスで個別にログインが必要です。

### Q8: 通知をオフにできますか？
A: はい、ブラウザの設定から通知をオフにできます。

### Q9: アプリをインストールする必要がありますか？
A: いいえ、ブラウザで利用できます。ただしホーム画面に追加するとより便利です。

### Q10: 海外でも使えますか？
A: はい、インターネット接続があればどこでも使えます。

## サポート対象ブラウザ

### 完全サポート
- Chrome 90以上
- Edge 90以上
- Safari 14以上
- Firefox 88以上

### モバイル
- iOS Safari 14以上
- Android Chrome 90以上

### PWA機能
- Chrome、Edge、Safari（一部機能）
- Firefoxは一部機能に制限あり

## 更新履歴

### v1.0.0（現在）
- Discord認証システム
- 旅行予定の登録・編集・削除
- カレンダービュー・リストビュー
- 国・地域フィルター
- 合流募集機能
- 参加者管理
- 通知機能（ブラウザ通知、バッジ）
- PWA対応

### 今後の予定
- バックエンド連携（Django REST Framework）
- データの永��化
- マルチデバイス同期
- リアルタイム通知
- チャット機能（検討中）
- 旅行写真の共有（検討中）

---

**アプリURL**: （本番環境のURL）  
**サポート**: （サポート連絡先）  
**Discord Server**: （対象のDiscordサーバー招待リンク）
